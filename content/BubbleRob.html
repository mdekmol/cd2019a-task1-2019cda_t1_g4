<!doctype html>
<html><head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>CMSimfly</title> <link rel="stylesheet" type="text/css" href="./../static/cmsimply.css">
<script src="tipuesearch_content.js"></script>
<script src="./../static/jquery.js"></script>
<link rel="stylesheet" href="./../static/tipuesearch/css/tipuesearch.css">
<script src="./../static/tipuesearch/tipuesearch_set.js"></script>
<script src="./../static/tipuesearch/tipuesearch.min.js"></script>

<script type="text/javascript" src="./../static/syntaxhighlighter/shCore.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushJScript.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushJava.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushPython.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushSql.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushXml.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushPhp.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushLua.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushCpp.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushCss.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushCSharp.js"></script>
<link type="text/css" rel="stylesheet" href="./../static/syntaxhighlighter/css/shCoreDefault.css"/>
<script type="text/javascript">SyntaxHighlighter.all();</script>

<!-- for LaTeX equations 暫時不用
<script src="https://scrum-3.github.io/web/math/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>
<script type="text/javascript">
init_mathjax = function() {
    if (window.MathJax) {
        // MathJax loaded
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
            },
            displayAlign: 'left', // Change this to 'center' to center equations.
            "HTML-CSS": {
                styles: {'.MathJax_Display': {"margin": 0}}
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
}
init_mathjax();
</script>
-->
<!-- 暫時不用
<script src="./../static/fengari-web.js"></script>
<script type="text/javascript" src="./../static/Cango-13v08-min.js"></script>
<script type="text/javascript" src="./../static/CangoAxes-4v01-min.js"></script>
<script type="text/javascript" src="./../static/gearUtils-05.js"></script>
-->
<!-- for Brython 暫時不用
<script src="https://scrum-3.github.io/web/brython/brython.js"></script>
<script src="https://scrum-3.github.io/web/brython/brython_stdlib.js"></script>
-->

<script type="text/javascript">
/*shorthand of $(document).ready(function(){};); */
$(function(){
    $("ul.topmenu> li:has(ul) > a").append('<div class="arrow-right"></div>');
    $("ul.topmenu > li ul li:has(ul) > a").append('<div class="arrow-right"></div>');
});
function doSearch() {
     $('#tipue_search_input').tipuesearch({
        newWindow: true, minimumLength: 2
     });
}
$(document).ready(doSearch);
</script>

</head><header><h1>產品協同設計第4組</h1> <confmenu>
<ul>
<li><a href="index.html">Home</a></li>
<li><a href="sitemap.html">Site Map</a></li>
<li><a href="./../reveal/index.html">reveal</a></li>
<li><a href="./../blog/index.html">blog</a></li>

</ul>
</confmenu></header>
<div class='container'><nav><ul id='css3menu1' class='topmenu'><div class="tipue_search_group"><input style="width: 6vw;" type="text" name="q" id="tipue_search_input" pattern=".{2,}" title="Press enter key to search" required></div><li><a href='簡介.html'>簡介</a><ul><li><a href='組員.html'>組員</a></li></ul><li><a href='課程內容.html'>課程內容</a><ul><li><a href='第一週.html'>第一週</a><li><a href='第二週.html'>第二週</a><li><a href='第三週.html'>第三週</a><li><a href='第四週.html'>第四週</a><li><a href='第五週.html'>第五週</a></li></ul><li><a href='可攜系統.html'>可攜系統</a><ul><li><a href='SSH步驟.html'>SSH步驟</a><li><a href='可攜系統製作步驟.html'>可攜系統製作步驟</a><li><a href='start的製作.html'>start的製作</a><li><a href='stop的製作.html'>stop的製作</a></li></ul><li><a href='Kungit  製作.html'>Kungit  製作</a><ul><li><a href='kungit上推.html'>kungit上推</a></li></ul><li><a href='實習任務.html'>實習任務</a><ul><li><a href='實習任務一.html'>實習任務一</a><ul><li><a href='建立個人可攜系統.html'>建立個人可攜系統</a><li><a href='分組程式修正.html'>分組程式修正</a></li></ul><li><a href='實習任務二.html'>實習任務二</a></li></ul><li><a href='Git手冊.html'>Git手冊</a><ul><li><a href='Git 分支.html'>Git 分支</a><li><a href='Git Internals.html'>Git Internals</a><li><a href='Git and Other Systems.html'>Git and Other Systems</a></li></ul><li><a href='V-rep.html'>V-rep</a><ul><li><a href='內容簡介.html'>內容簡介</a><li><a href='操作方式.html'>操作方式</a><li><a href='Cone Proximity Sensor.html'>Cone Proximity Sensor</a></li></ul><li><a href='BubbleRob.html'>BubbleRob</a></li></ul></nav><section><div id="tipue_search_content">Cone Proximity Sensor << <a href='Cone Proximity Sensor.html'>Previous</a> <br /><h1>BubbleRob</h1>
<p><span></span><span><span><span><span><span><span>1.建立BubbleRob本體<br/><span>新增一個</span><span>Sphere</span><span>，</span><span>X-size</span><span>為</span><span>0.2(</span><span>單位為m)</span><br/><span>在</span><span>object common properties</span><span>下的</span><span>object special properties</span><span>將</span><span>Collidable、Measurable、Renderable、Detectable</span><span>都打勾，將本體位置設定在Z軸(Along Z)0.02(須確認本體是照world移動)</span><span>接著在選單雙擊Sphere將物件名稱改為BubbleRob就完成本體設定。</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><img alt="" height="111" src="./../images/1.png" width="362"/><br/></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><br/><span>2.建立Proxmity sensor</span><br/><span>在選單中建立一個</span><span>Proximity sensor</span><span>且選為</span><span>Cone type</span><span>將sensor利用旋轉功能在</span><span>Around Y及Z</span><span>輸入</span><span>90</span><span>位置為</span><span>X-coord</span><span>輸入</span><span>0.1</span><span>及</span><span>Z-coord</span><span>輸入</span><span>0.12</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><img alt="" height="201" src="./../images/2.png" width="381"/></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/></span></span></span></span></span></span><img alt="" height="202" src="./../images/3.png" width="376"/></p>
<p><span><span><span><span><span><span><span>接著設定sensor感應範圍，在選單點擊感測器符號開啟它的設定框，點擊</span><span>show volume </span><br/><span>parameter</span><span>開啟選單設定</span><span>Offset=0.005</span><span>、</span><span>Angle=30</span><span>、</span><span>Range=0.15</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><img alt="" height="626" src="./../images/4.png" width="384"/><br/></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><span>點擊</span><span>Show detection parameters</span><span>，將"</span><span>Don't allow detections if distance smaller than"</span><span>選項取消打勾。</span><br/><span>將感測器名稱設定為</span><span>bubbleRob_sensingNose</span><span>，就完成感測器設定了。</span><br/><span>在</span><span>Scene hireachy</span><span>(場景等級)將完成設定的sensor放在bubbleRob下</span><span>最後將兩項物件</span><span>Edit-&gt;"Make last selected object parent"</span><span>連結成一個物件。</span><br/><br/><span>3.建立bubbleRob的輪子</span><br/><span>建立一個</span><span>cylinder</span><span>尺寸為(0.08,0.08,0.02)，跟本體一樣將</span><span>object common properties</span><span>內的特殊屬性都打開，設定位置(0.05,0.1,0.04)和旋轉(-90,0,0)，此物件命名為</span><span>bubbleRob_leftWheel</span><span>，然後將完成的物件複製一份且將位置參數Y設定為-0.1，此物件命名為</span><span>bubbleRob_RightWheel</span><br/><span>設定</span><span>joint</span><span>(motor)</span><br/><span>Add-&gt;joint-&gt;Revolute</span><span>建立一個軸，建立完成按住ctrl選擇剛剛的</span><span>bubbleRob_leftWheel</span><span>然後在</span><span>postion</span><span>及</span><span> orientation</span><span>內選擇</span><span>apply to selection</span><span>來複製輪子的參數，這樣軸的位置就會跟左邊輪子一樣了。</span><br/><span>點擊開啟軸參數的設定框，將 </span><span>Show dynamic parameters</span><span>內的</span><span>enable the motor</span><span>以及底下的</span><span>Lock motor when target velocity is zero</span><span>都打勾，完成左邊輪軸設定後，用同樣方式製作右輪軸。</span><br/><span>最後將輪子層級放置在輪軸底下，輪軸層級則置於本體下</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><img alt="" height="85" src="./../images/5.png" width="192"/><br/></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><br/><span>4.建立slider</span><br/><span>開始模擬後發現機器人會向後翻轉，因為少了第三個接地點</span><br/><span>建立一個圓形物件(設定0.05)，一樣打開所有特殊屬性，將此物件命名為 </span><span>bubbleRob_slider</span><span>，在</span><span>shape dynamics properties</span><span>裡將物件設定為</span><span>無摩擦</span><span>。</span><br/><span>摩擦力相關的係數都調成0</span><br/><br/><span>接著建立</span><span><strong>Force sensor</strong></span><span>命名為</span><strong><span>bubbleRob_connection</span></strong><span>，將它往上提0.05</span><br/><span>，再跟剛剛的滑塊接合成一個物件，這個物件的位置設定X=(-0.07)，此物件的層級則放在bubbleRob底下，這樣就完成第三個接地點了，但是執行模擬後會發現滑塊會微微震動，那是因為滑塊跟本體互相碰撞了，為了避免這種狀況，開啟滑塊及本體的</span><span><strong>shape dynamics properties</strong></span><span>將</span><strong><span>local respondable mask</span></strong><span>分別設定為00001111及</span><br/><span>11110000這樣兩個物件就不會互相碰撞了。</span><br/><span>滑塊設定</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><img alt="" height="123" src="./../images/6.png" width="504"/><br/></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><span>本體設定</span><br/><br/></span></span></span></span></span></span></p>
<p><img alt="" height="149" src="./../images/7.png" width="383"/></p>
<p><span><span><span><span><span><span><br/></span></span></span></span></span></span><span><span><span><span><span><span><span>5.增加stability及Target velocity</span><span>測試</span><br/><span>點擊dynamic對話框內的</span><span>M=M*2</span><span>選項三次將輪子以及第三個支點的重量變成8倍，接著在軸的dynamic對話框將</span><span>Target velocity</span><span>設至50後開始演算，會發現bubbleRob會穩定的直線前進最後掉出平台，然後再將速度重置為0，測試就完成了。</span><br/><br/><br/><span>6.</span><span>collection object</span><span>及</span><span>Calculation module properties</span><br/><span>在collection對話框內用Add new collection，新增的集合是空的，將列表上的bubbleRob選擇後點選Add加進collection，命名為 bubbleRob_collection ，這樣bubbleRob底下的零件都包含集合裡。</span><br/><span>在選單點選</span><span>Calculation module</span><span>在</span><span>distance</span><span>下</span><span>Add new distance object</span><span>，選擇剛剛新增的</span><span>bubbleRob_collection</span><span>及</span><span>all other measurable objects in the scene</span><span>，</span><br/><span>命名為</span><span>bubbleRob_distance</span><span>，這個設定在之後會測量本體以及其他可碰撞物件之間的最小距離。</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/></span></span></span></span></span></span><span><span><span><span><span><span><img alt="" height="138" src="./../images/8.png" width="398"/></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><span>7.Graph設定</span><br/><span>新增一個Graph命名為</span><span>bubbleRob_graph</span><span>在列表上放置於bubbleRob底下將graph位置設定在(0,0,0.005)開啟graph properties，將</span><span>Display XYZ-planes</span><span>選項取消打勾，接著</span><span>Add new data stream to record</span><span>，視窗上方(</span><span>Data stream type</span><span>)選擇</span><span>Object: absolute x-position</span><span>下方(</span><span><span>Object / item to record</span>)</span><span>選擇</span><span>bubbleRob_graph</span><span>，在</span><span>Data stream recording list</span><span>會出現剛剛新增的設定，Y軸跟Z軸也用同樣方式做設定。</span><br/><span>為了能夠測量機器人跟環境之間的最小距離再新增一個設定上面選擇</span><span>Distance:segment length</span><span>下方選擇</span><span>bubbleRob_distance</span><span>。</span><br/><br/><span>將XYZ軸及距離設定分別命名為</span><span>bubbleRob_xpos、bubbleRob_ypos、bubbleRob_zpos、 bubbleRob_obstacle_dist。</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><img alt="" height="600" src="./../images/12.png" width="379"/><br/></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><span>選擇bubbleRob_xpos在底下的</span><strong><span>Time graph properties</span></strong><span>將Visible取消掉，其他兩軸也用相同方式操作。</span><br/><span>接著在Edit 3D curves點選 Add new curve設定如圖</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><img alt="" height="145" src="./../images/14.png" width="282"/><br/></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><span>Curve width</span><span>設定為4，然後改成</span><span>Relative to world</span><span>，完成後測試就會發現機器人的路徑會以線顯示在螢幕上。</span><br/><br/><br/><span>8.建立cylinder</span><br/><span>增加數個(0.1,0.1,0.2)的cylinder包圍bubbleRob，將cylinder的特殊屬性參數全部打開，移動cylinder途中按著shift可以進行更細微的移動，按住ctrl則可以讓物件可以在正交方向移動。</span><br/><br/><span>9.model設定</span><br/><span>選擇bubbleRob後在</span><span><strong>object common properties</strong></span><span>內將</span><span><strong>Object is model base</strong></span><span>和</span><strong><span>Object/model can transfer or accept DNA</span></strong><span>都打勾，這樣bubbleRob邊界框就包含底下所有的物件在內了。</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><img alt="" height="618" src="./../images/15.png" width="388"/><br/></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><span>接著將兩個joint、sensor跟graph都選起來然後將參數設定</span><strong><span>ignored by model bounding box</span></strong><span>，讓模型的邊界框略過sensor跟joint然後將joint跟sensor的camera visibility layer 2取消打勾改為打勾</span><br/><span>10，這樣在畫面上就不會看見軸跟sensor範圍了，最後將感測器、兩個輪子、支點、圖表的</span><strong><span>Select base of model instead</span></strong><span>都打勾，這項設定讓我們只能一次移動整個機器人而不是單個零件，能避免定位好的零件被移動。</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><img alt="" height="215" src="./../images/16.png" width="382"/></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><span>10.感測器(vision sensor)</span><br/><span>增加一個新的感測器，位置、角度跟BubbleRob's proximity sensor同樣，在畫面上點選增加</span><span>Perspective type</span><span>的sensor，然後放到proximity sensor底下，新的sensor設定如下</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><img alt="" height="542" src="./../images/17.png" width="385"/></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/></span></span></span></span></span></span><span><span><span><span><span><span><span>著點擊Show filter dialog開啟filter對話框，選擇</span><span>Edge detection on work image</span><span>然後按</span><span>Add</span><span>，新增的過濾組件要上移至第二層，移動完後點擊兩下剛剛設定的組件將Threshold(閾值)設定為0.2，設定到這邊基本上就完成了。</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><img alt="" height="368" src="./../images/18.png" width="385"/><br/></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><span>完成sensor設定後新增一個</span><span>floating view</span><span>然後在它上面右鍵選擇(view-&gt;Associate view with selected vision sensor)將視窗綁定到剛剛設定完的sensor上(要確保sensor是被選擇的狀況)，接著試著開始模擬，視窗上能夠看見目標就成功了。</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><img alt="" height="219" src="./../images/19.png" width="374"/><br/></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><span>11.程式:</span><span>位於工具列的script功能可以編輯code</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><span></span><br/><img alt="" height="49" src="./../images/20.png" width="49"/><br/></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><span>最後的步驟要將code放進完成的模型內，選擇bubbleRob點選(</span><span>Add-&gt;Associated child script --&gt; Non threaded</span><span>)</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><img alt="" height="328" src="./../images/21.png" width="491"/><br/></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><span>新增一個</span><span><strong>non-threaded child script</strong></span><span>，接著點選bubbleRob旁邊的圖示</span><span>就能打開script，將code複製在原本的code後面關掉視窗就完成了。</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><img alt="" height="62" src="./../images/22.png" width="198"/><br/></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><span>需注意code內部</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><span> <img alt="" height="221" src="./../images/23.png" width="1045"/></span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/><span>leftMotor=sim.getObjectHandle("</span><span>bubbleRob_leftMotor</span><span>") -- Handle of the left motor</span><br/><span>rightMotor=sim.getObjectHandle("</span><span>bubbleRob_rightMotor</span><span>") -- Handle of the right motor</span><br/><span>noseSensor=sim.getObjectHandle("</span><span>bubbleRob_sensingNose</span><span>") -- Handle of the proximity sensor</span><br/><span>紅框內的名稱，如果大小寫或是名稱不同程式就沒辦法成功執行。</span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><br/></span></span></span></span></span></span><span><span><span><span><span><span><img alt="" height="858" src="./../images/24.png" width="1461"/><br/><span></span></span></span></span></span></span></span></p>
<p><span><span><span><span><span><span><span>bubbleRob在模擬時會自動避開路徑上的物件，且畫面有能調節速度的面板。</span><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/></span></span></span></span></span></span></p>
</div><br />Cone Proximity Sensor << <a href='Cone Proximity Sensor.html'>Previous</a> </div></section></div></body></html>